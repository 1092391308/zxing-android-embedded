language: java
jdk: oraclejdk7

before_install:
    # Install base Android SDK
    - sudo apt-get update -qq
    - if [ `uname -m` = x86_64 ]; then sudo apt-get install -qq libc6:i386 libgcc1:i386 gcc-4.6-base:i386 libstdc++5:i386 libstdc++6:i386 lib32z1 libreadline6-dev:i386 libncurses5-dev:i386; fi
    - wget http://dl.google.com/android/android-sdk_r22-linux.tgz
    - tar xzf android-sdk_r22-linux.tgz
    - export ANDROID_HOME=$PWD/android-sdk-linux
    - export PATH=${PATH}:${ANDROID_HOME}/tools:${ANDROID_HOME}/platform-tools

    # Install required Android components.
    # Note that the command below only accepts the first license. This is actually convenient, since
    # it prevents the installation of the ATOM and MIPS emulator images.
    - echo yes | android update sdk --filter platform-tools,android-17,extra-android-support,extra-google-gcm,build-tools-17.0.0,extra-google-m2repository,extra-android-m2repository --no-ui --force

install:
    - ./gradlew tasks
    - mvn install -DskipTests=true

script:
    - ./gradlew build
    - mvn install
